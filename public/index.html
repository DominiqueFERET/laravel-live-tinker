<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>LiveTinker</title>
    <style type="text/css" media="screen">
        body {
            overflow: hidden;
        }

        #editor {
            margin: 0;
            position: absolute;
            top: 0;
            bottom: 50%;
            left: 0;
            right: 0;
        }

        #editor-result {
            margin: 0;
            position: absolute;
            top: 55%;
            bottom: 100%;
            left: 0;
            right: 0;
            width: 100%;
            height: 100%;
        }

        #run {
            margin: 0;
            position: absolute;
            top: 51%;
            width: 120px;
            height: 25px;
            left: 0;
        }

        #run-selected {
            margin: 0;
            position: absolute;
            top: 51%;
            width: 120px;
            height: 25px;
            left: 15%;
        }
    </style>
</head>
<body>

<div id="editor">
function nfact($n) {
    if ($n == 0) {
        return 1;
    }
    else {
        return $n * nfact($n - 1);
    }
}

$num = 10;

$output = "\n\nFactorial " . $num . " = " . nfact($num) . "\n\n";
echo $output;

</div>
<textarea id="editor-result"></textarea>
<button id="run" onclick="send(editor.getValue())">Run</button>
<button id="run-selected" onclick="send(editor.getSelectedText())">Run selected</button>


<script src="assets/js/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    var socket = new WebSocket("ws://0.0.0.0:2346");

    editor.session.setMode({path: "ace/mode/php", inline: true});

    socket.onmessage = function (data) {
        document.getElementById('editor-result').innerHTML = data.data;
    };

    function send(text) {
        // console.log(editor.getSelectedText());
        socket.send(text)
    }
</script>

</body>
</html>
